<div id="admin-content">
    <div class="container">
        <div class="row">
            <div class="col-md-10">
                <h1 class="admin-heading"><i class="fa fa-users"></i> All Recent Projects</h1>
            </div>
            <div class="col-md-2">
                <a class="add-new" href="/admin/recent-Project">add Recent Project</a>
            </div>
            <div class="col-md-12">
                
                <div id="projectTable"></div>
                
            </div>
        </div>
    </div>
</div>
<script src="/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="/js/tabulator.min.js"></script>

<script>
const tableData= <%- JSON.stringify(project) %>;

var table= new Tabulator('#projectTable',{
    data : tableData,
    layout : "fitColumns",
    pagination : true,
    paginationSize:10,
    paginationSizeSelector:[5,10,25,50,100],
    columns : [
         {title: "S.No.", formatter:"rownum",width:100,hozAlign:'center'},
        {title : "Project Name", field : "Project_title", headerFilter : "input"},
        {title : "Project Description", field : "project_description", headerFilter : "input"},
        {title : "Image", field : "project_image", formatter: function(cell){
    const imgPath = `/uploads/${cell.getValue()}`;
    return `<img src="${imgPath}" width="60" height="40" style="object-fit:cover;">`;
}},


       
        {title : "Actions", formatter: function(cell, formatterParams, onRendered){
            return `<button class="btn btn-sm btn-danger delete-project" onclick="deleteproject('${cell.getData()._id}')">Delete</button>`
        
        }}

    ]
});

async function deleteproject(id){
    try{
        if(confirm('Are you sure you want to delete this user?')){
           const response = await fetch(`/admin/delete-recentprojcet/${id}`,{
                method:'delete'
            });
            if(response.ok){
                window.location.reload();
            }
        }
    } catch(error){
        console.log(error);
    }   
}
</script>
<%- contentFor('tabulatorCSS') %>
<link href="/css/tabulator.min.css" rel="stylesheet">
    <link href="/css/tabulator_bootstrap5.css" rel="stylesheet">